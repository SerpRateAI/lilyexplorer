Starting script...
Torch imported
/home/other/johna/.local/lib/python3.10/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.8.1' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/home/other/johna/.local/lib/python3.10/site-packages/pandas/core/arrays/masked.py:61: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.2' currently installed).
  from pandas.core import (
/usr/lib/python3/dist-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.17.3 and <1.25.0 is required for this version of SciPy (detected version 1.26.4
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
====================================================================================================
VAE v2.7 TRAINING: v2.6 + MAD FEATURES
====================================================================================================

Loading v2.7 dataset...
Total samples: 12,198
Total boreholes: 196
Unique lithologies: 120

Feature summary:
  GRA_bulk_density    : mean=   1.751, std=   0.246
  MS                  : mean= 126.023, std= 343.200
  NGR                 : mean=  30.978, std=  22.698
  RGB_R               : mean=  74.295, std=  45.956
  RGB_G               : mean=  72.450, std=  45.330
  RGB_B               : mean=  65.708, std=  41.349
  Porosity            : mean=  47.692, std=  16.126
  Grain_Density       : mean=   2.717, std=   0.127
  Water_Content       : mean=  27.376, std=  12.495

Creating borehole-level train/val/test split...
Train: 9,073 samples from 137 boreholes
Val:   1,467 samples from  29 boreholes
Test:  1,658 samples from  30 boreholes

Applying distribution-aware scaling...
Scaled features: 9D

Device: cuda

Model parameters: 2,205

====================================================================================================
TRAINING
====================================================================================================

Epoch   1: Train Loss=9.0083, Val Loss=6.3353, β=0.000000
Epoch   5: Train Loss=4.0551, Val Loss=2.8370, β=0.060000
Epoch  10: Train Loss=2.7927, Val Loss=2.3516, β=0.135000
Epoch  15: Train Loss=2.6935, Val Loss=2.4472, β=0.210000
Epoch  20: Train Loss=2.8102, Val Loss=2.5431, β=0.285000
Epoch  25: Train Loss=2.9863, Val Loss=2.7165, β=0.360000

Early stopping at epoch 26

Training time: 5.4s (0.1 min)
Best validation loss: 2.3447

====================================================================================================
GENERATING EMBEDDINGS
====================================================================================================

Train embeddings: (9073, 10)
Test embeddings: (1658, 10)

====================================================================================================
CLUSTERING EVALUATION
====================================================================================================

k=10: ARI=0.271, Silhouette=0.161
k=12: ARI=0.277, Silhouette=0.137
k=15: ARI=0.281, Silhouette=0.110
k=20: ARI=0.245, Silhouette=0.088

Average: ARI=0.268, Silhouette=0.124

====================================================================================================
COMPARISON TO v2.6
====================================================================================================

v2.6 (239K samples, 6 features): ARI = 0.196
v2.7 (12K samples, 9 features):  ARI = 0.268 (+37.0%)

✓ SUCCESS: MAD features improve clustering despite -95% sample reduction!
  Porosity/grain density/water content are highly discriminative.

✓ Model saved to: /home/utig5/johna/bhai/ml_models/checkpoints/vae_gra_v2_7.pth

✓ Clustering results saved to: vae_v2_7_clustering_results.csv

====================================================================================================
VAE v2.7 TRAINING COMPLETE
====================================================================================================
