/home/other/johna/.local/lib/python3.10/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.8.1' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/home/other/johna/.local/lib/python3.10/site-packages/pandas/core/arrays/masked.py:61: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.2' currently installed).
  from pandas.core import (
/usr/lib/python3/dist-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.17.3 and <1.25.0 is required for this version of SciPy (detected version 1.26.4
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/other/johna/.local/lib/python3.10/site-packages/matplotlib/projections/__init__.py:63: UserWarning: Unable to import Axes3D. This may be due to multiple versions of Matplotlib being installed (e.g. as a system package and as a pip package). As a result, the 3D projection is not available.
  warnings.warn("Unable to import Axes3D. This may be due to multiple versions of "
Warning: UMAP not available, will use PCA only for 8D visualization
Warning: UMAP not available, will use PCA only for 8D visualization
================================================================================
VAE GRA v2.1 vs v3 Performance Comparison
================================================================================

Loading data...
Loaded 50,000 samples, 129 unique lithologies

================================================================================
VAE GRA v2.1 - Unified Encoder
================================================================================
Latent shape: (50000, 8)

Clustering performance:
  k= 5: Silhouette=0.387, ARI=0.086
  k=10: Silhouette=0.415, ARI=0.099
  k=15: Silhouette=0.387, ARI=0.092
  k=20: Silhouette=0.377, ARI=0.091

================================================================================
VAE GRA v3 - Dual Encoder (Physical + Visual)
================================================================================
Latent shape: (50000, 8)

Clustering performance:
  k= 5: Silhouette=0.406, ARI=0.077
  k=10: Silhouette=0.392, ARI=0.091
  k=15: Silhouette=0.376, ARI=0.100
  k=20: Silhouette=0.366, ARI=0.091

High-purity clusters (k=20):
  Cluster 16: 61.0% nannofossil ooze (n=3504)
  Cluster 10: 57.7% nannofossil ooze (n=3478)
  Cluster 3: 46.7% gabbro (n=1034)

================================================================================
PERFORMANCE COMPARISON SUMMARY
================================================================================

| k  | Metric     | v2.1  | v3    | Change  |
|----|------------|-------|-------|---------|
|  5 | ARI        | 0.086 | 0.077 |  -10.6% |
|    | Silhouette | 0.387 | 0.406 |   +4.8% |
| 10 | ARI        | 0.099 | 0.091 |   -7.9% |
|    | Silhouette | 0.415 | 0.392 |   -5.6% |
| 15 | ARI        | 0.092 | 0.100 |   +8.9% |
|    | Silhouette | 0.387 | 0.376 |   -2.9% |
| 20 | ARI        | 0.091 | 0.091 |   +0.1% |
|    | Silhouette | 0.377 | 0.366 |   -2.9% |

================================================================================
MODEL ARCHITECTURE
================================================================================

v2.1: 2,102 parameters
  - Unified encoder: 6D → [32, 16] → 8D
  - Unified decoder: 8D → [16, 32] → 6D

v3: 1,270 parameters (60.4% of v2.1)
  - Physical encoder: 3D → [16, 8] → 4D
  - Visual encoder:   3D → [16, 8] → 4D
  - Fusion: concat(4D + 4D) → 8D
  - Physical decoder: 8D → [8, 16] → 3D
  - Visual decoder:   8D → [8, 16] → 3D

================================================================================
KEY FINDINGS
================================================================================

1. Performance at k=10:
   v2.1 ARI: 0.099
   v3 ARI:   0.091
   Change:   -7.9%

2. Model efficiency:
   v3 has 61.5% of v2.1's parameters
   Both use same 8D latent space

3. CONCLUSION: ✗ Dual encoders HURT performance
   Stick with v2.1

================================================================================
