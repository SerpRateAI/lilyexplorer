2025-10-15 10:19:22,901 - INFO - ================================================================================
2025-10-15 10:19:22,901 - INFO - VAE Lithology Model Training
2025-10-15 10:19:22,901 - INFO - ================================================================================
2025-10-15 10:19:22,901 - INFO - Target boreholes: 212
2025-10-15 10:19:22,901 - INFO - 
================================================================================
2025-10-15 10:19:22,902 - INFO - STEP 1: Loading and merging datasets
2025-10-15 10:19:22,902 - INFO - ================================================================================
2025-10-15 10:19:22,902 - INFO - Loading MAD dataset (porosity, grain density)...
2025-10-15 10:19:23,017 - INFO - MAD dataset: 26476 rows
2025-10-15 10:19:23,017 - INFO - Loading PWC dataset (P-wave velocity)...
2025-10-15 10:19:23,126 - INFO - PWC dataset: 28445 rows
2025-10-15 10:19:23,127 - INFO - Loading TCON dataset (thermal conductivity)...
2025-10-15 10:19:23,228 - INFO - TCON dataset: 30330 rows
2025-10-15 10:19:23,250 - INFO - Filtering to 212 specified boreholes...
2025-10-15 10:19:23,274 - INFO - After filtering - MAD: 19819, PWC: 22386, TCON: 20833
2025-10-15 10:19:23,282 - INFO - Merging datasets on Borehole_ID and depth (resolution: 0.05m)...
2025-10-15 10:19:23,295 - INFO - Merged dataset: 187 rows
2025-10-15 10:19:23,296 - INFO - After removing missing values: 166 rows (dropped 21)
2025-10-15 10:19:23,297 - INFO - After outlier filtering: 151 rows (dropped 15)
2025-10-15 10:19:23,305 - INFO - 
================================================================================
2025-10-15 10:19:23,305 - INFO - Data Statistics
2025-10-15 10:19:23,305 - INFO - ================================================================================
2025-10-15 10:19:23,305 - INFO - Total samples: 151
2025-10-15 10:19:23,306 - INFO - Unique boreholes: 21
2025-10-15 10:19:23,306 - INFO - Unique principal lithologies: 18
2025-10-15 10:19:23,306 - INFO - 
Top 10 principal lithologies:
2025-10-15 10:19:23,306 - INFO - Principal
nannofossil ooze              79
mud                           14
clayey silt                   12
very fine sand                 6
clay                           6
lapillistone                   4
volcanic rock                  4
medium to coarse sandstone     3
mudstone                       3
calcareous ooze                3
Name: count, dtype: int64
2025-10-15 10:19:23,307 - INFO - 
================================================================================
2025-10-15 10:19:23,307 - INFO - STEP 2: Preparing data for training
2025-10-15 10:19:23,307 - INFO - ================================================================================
2025-10-15 10:19:23,307 - INFO - Total unique boreholes: 21
2025-10-15 10:19:23,308 - INFO - Borehole split - Train: 14, Val: 2, Test: 5
2025-10-15 10:19:23,310 - INFO - Sample split - Train: 69, Val: 14, Test: 68
2025-10-15 10:19:23,311 - INFO - Feature statistics (before normalization):
2025-10-15 10:19:23,312 - INFO -   Porosity (vol%): mean=45.186, std=18.171
2025-10-15 10:19:23,312 - INFO -   Grain density (g/cm^3): mean=2.711, std=0.076
2025-10-15 10:19:23,312 - INFO -   P_wave_velocity: mean=1995.290, std=658.094
2025-10-15 10:19:23,312 - INFO -   Thermal conductivity mean (W/(m*K)): mean=1.565, std=0.840
2025-10-15 10:19:23,692 - INFO - 
Using device: cuda
2025-10-15 10:19:23,692 - INFO - 
================================================================================
2025-10-15 10:19:23,692 - INFO - STEP 3: Training VAE with latent_dim=2
2025-10-15 10:19:23,692 - INFO - ================================================================================
2025-10-15 10:19:23,725 - INFO - 
Model architecture:
2025-10-15 10:19:23,725 - INFO - VAE(
  (encoder): Sequential(
    (0): Linear(in_features=4, out_features=16, bias=True)
    (1): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): LeakyReLU(negative_slope=0.2)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=16, out_features=32, bias=True)
    (5): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): LeakyReLU(negative_slope=0.2)
    (7): Dropout(p=0.2, inplace=False)
  )
  (fc_mu): Linear(in_features=32, out_features=2, bias=True)
  (fc_log_var): Linear(in_features=32, out_features=2, bias=True)
  (decoder): Sequential(
    (0): Linear(in_features=2, out_features=32, bias=True)
    (1): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): LeakyReLU(negative_slope=0.2)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=32, out_features=16, bias=True)
    (5): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): LeakyReLU(negative_slope=0.2)
    (7): Dropout(p=0.2, inplace=False)
    (8): Linear(in_features=16, out_features=4, bias=True)
  )
)
2025-10-15 10:19:23,725 - INFO - Total trainable parameters: 1,640
