/home/other/johna/.local/lib/python3.10/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.8.1' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/home/other/johna/.local/lib/python3.10/site-packages/pandas/core/arrays/masked.py:61: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.2' currently installed).
  from pandas.core import (
/usr/lib/python3/dist-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.17.3 and <1.25.0 is required for this version of SciPy (detected version 1.26.4
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/other/johna/.local/lib/python3.10/site-packages/matplotlib/projections/__init__.py:63: UserWarning: Unable to import Axes3D. This may be due to multiple versions of Matplotlib being installed (e.g. as a system package and as a pip package). As a result, the 3D projection is not available.
  warnings.warn("Unable to import Axes3D. This may be due to multiple versions of "
Warning: UMAP not available, will use PCA only for 8D visualization
Warning: UMAP not available, will use PCA only for 8D visualization
================================================================================
VAE GRA v2.1 vs v2.2 Performance Comparison
================================================================================
Using device: cpu


================================================================================
VAE GRA v2.1 - 6D Input (Current Position Only)
================================================================================

Loading v2.1 model and data...
  Sampled 50,000 rows
  Data shape: (50000, 6)
  Unique lithologies: 129

Scaling and encoding to latent space...
  Latent shape: (50000, 8)

Clustering performance (v2.1):
  k= 5: Silhouette=0.387, ARI=0.086
  k=10: Silhouette=0.415, ARI=0.099
  k=15: Silhouette=0.387, ARI=0.092
  k=20: Silhouette=0.377, ARI=0.091

High-purity clusters (k=20):
  1. Cluster 6: 60.7% nannofossil ooze (n=3556)
  2. Cluster 13: 49.4% gabbro (n=897)
  3. Cluster 5: 48.4% nannofossil ooze (n=3566)

================================================================================
VAE GRA v2.2 - 18D Input (With Spatial Context)
================================================================================

Loading v2.2 model and data...
  Sampled 50,000 rows
  Data shape: (50000, 18)
  Unique lithologies: 129

Scaling and encoding to latent space...
  Latent shape: (50000, 8)

Clustering performance (v2.2):
  k= 5: Silhouette=0.375, ARI=0.076
  k=10: Silhouette=0.414, ARI=0.103
  k=15: Silhouette=0.392, ARI=0.091
  k=20: Silhouette=0.376, ARI=0.090

High-purity clusters (k=20):
  1. Cluster 14: 61.5% nannofossil ooze (n=3496)
  2. Cluster 8: 50.1% gabbro (n=837)
  3. Cluster 2: 47.9% nannofossil ooze (n=3310)

================================================================================
PERFORMANCE COMPARISON SUMMARY
================================================================================

| k-clusters | Metric     | v2.1   | v2.2   | Change   |
|------------|------------|--------|--------|----------|
| k= 5       | ARI        | 0.086  | 0.076  |  -11.6% |
|            | Silhouette | 0.387  | 0.375  |   -3.1% |
| k=10       | ARI        | 0.099  | 0.103  |   +3.9% |
|            | Silhouette | 0.415  | 0.414  |   -0.3% |
| k=15       | ARI        | 0.092  | 0.091  |   -0.9% |
|            | Silhouette | 0.387  | 0.392  |   +1.4% |
| k=20       | ARI        | 0.091  | 0.090  |   -1.3% |
|            | Silhouette | 0.377  | 0.376  |   -0.2% |

================================================================================
Key Findings:
================================================================================

1. Spatial context effect at k=10:
   - v2.1 ARI: 0.099
   - v2.2 ARI: 0.103
   - Change: +3.9%

2. Cluster purity comparison (k=20):
   v2.1 best: 60.7% nannofossil ooze
   v2.2 best: 61.5% nannofossil ooze

3. âœ“ Spatial context IMPROVES lithology discrimination

================================================================================
