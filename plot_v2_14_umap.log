/home/other/johna/.local/lib/python3.10/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.8.1' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/home/other/johna/.local/lib/python3.10/site-packages/pandas/core/arrays/masked.py:60: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.2' currently installed).
  from pandas.core import (
/home/other/johna/.local/lib/python3.10/site-packages/matplotlib/projections/__init__.py:63: UserWarning: Unable to import Axes3D. This may be due to multiple versions of Matplotlib being installed (e.g. as a system package and as a pip package). As a result, the 3D projection is not available.
  warnings.warn("Unable to import Axes3D. This may be due to multiple versions of "
/usr/lib/python3/dist-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.17.3 and <1.25.0 is required for this version of SciPy (detected version 1.26.4
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/other/johna/.local/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/other/johna/.local/lib/python3.10/site-packages/numba/np/ufunc/parallel.py:371: NumbaWarning: [1mThe TBB threading layer requires TBB version 2021 update 6 or later i.e., TBB_INTERFACE_VERSION >= 12060. Found TBB_INTERFACE_VERSION = 12050. The TBB threading layer is disabled.[0m
  warnings.warn(problem)
================================================================================
SEMI-SUPERVISED VAE v2.14 - UMAP VISUALIZATION
================================================================================
Loading dataset...
Test samples: 28,015
Unique lithologies: 60

Device: cuda
Loading checkpoint: ml_models/checkpoints/semisup_vae_alpha0.1.pth
âœ“ Model loaded (epoch 4)

Generating latent representations...
Active dimensions: 10/10
Dimension stds: [0.33055758 0.4015606  0.68276966 0.9969196  0.7313879  0.79428077
 0.7801263  0.47788322 1.0436513  0.38272467]

Clustering with GMM (k=18)...
âœ“ Adjusted Rand Index: 0.2205

Computing UMAP projection...
âœ“ UMAP shape: (28015, 2)

Creating cluster-based UMAP plot...
âœ“ Saved: v2_14_umap_projection.png

Creating lithology-based UMAP plot...
âœ“ Saved: v2_14_umap_by_lithology.png

================================================================================
COMPLETE
================================================================================
Generated:
  - v2_14_umap_projection.png (cluster-based)
  - v2_14_umap_by_lithology.png (lithology-based with labels)

Adjusted Rand Index: 0.2205
