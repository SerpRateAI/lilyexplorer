/home/other/johna/.local/lib/python3.10/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.8.1' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/home/other/johna/.local/lib/python3.10/site-packages/pandas/core/arrays/masked.py:61: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.2' currently installed).
  from pandas.core import (
/usr/lib/python3/dist-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.17.3 and <1.25.0 is required for this version of SciPy (detected version 1.26.4
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
Warning: UMAP not available, will use PCA only for 8D visualization
/home/other/johna/.local/lib/python3.10/site-packages/matplotlib/projections/__init__.py:63: UserWarning: Unable to import Axes3D. This may be due to multiple versions of Matplotlib being installed (e.g. as a system package and as a pip package). As a result, the 3D projection is not available.
  warnings.warn("Unable to import Axes3D. This may be due to multiple versions of "
====================================================================================================
LITHOLOGY CLASSIFIER USING v2.6.7 VAE EMBEDDINGS
====================================================================================================

Loading data...
Total samples: 238,506
Total boreholes: 296
Unique lithologies: 139

Number of classes: 139

Train: 174,636 samples (206 boreholes)
Val:   33,277 samples (45 boreholes)
Test:  30,593 samples (45 boreholes)

Loading v2.6.7 VAE model...
Device: cuda
✓ VAE loaded successfully

Scaling features...
✓ Features scaled

Extracting VAE embeddings...
✓ Embeddings extracted in 1.2s
  Embedding shape: (174636, 10)

Embedding statistics:
  Dim 0: std=0.9664 ✓
  Dim 1: std=0.8077 ✓
  Dim 2: std=0.0076 ✗
  Dim 3: std=0.2627 ✓
  Dim 4: std=0.0150 ✗
  Dim 5: std=0.0049 ✗
  Dim 6: std=0.0257 ✗
  Dim 7: std=0.0163 ✗
  Dim 8: std=0.3575 ✓
  Dim 9: std=0.0094 ✗

====================================================================================================
TRAINING LITHOLOGY CLASSIFIER
====================================================================================================
Classifier parameters: 7,371

Starting training...

Epoch   1: Train Loss=2.7044, Train Acc=31.72%, Val Loss=2.4652, Val Acc=36.61%
Epoch   5: Train Loss=2.0516, Train Acc=40.52%, Val Loss=2.3990, Val Acc=35.54%
Epoch  10: Train Loss=1.9624, Train Acc=41.84%, Val Loss=2.3990, Val Acc=36.96%
Epoch  15: Train Loss=1.9243, Train Acc=42.55%, Val Loss=2.4241, Val Acc=41.28%
Epoch  20: Train Loss=1.9010, Train Acc=42.95%, Val Loss=2.4705, Val Acc=38.71%
Epoch  25: Train Loss=1.8843, Train Acc=43.25%, Val Loss=2.5032, Val Acc=38.04%
Epoch  30: Train Loss=1.8687, Train Acc=43.42%, Val Loss=2.5177, Val Acc=38.64%
Epoch  35: Train Loss=1.8567, Train Acc=43.57%, Val Loss=2.5545, Val Acc=38.16%
Epoch  40: Train Loss=1.8484, Train Acc=43.68%, Val Loss=2.5728, Val Acc=38.98%

Early stopping at epoch 42

Best validation accuracy: 42.97%
Best validation loss: 2.5132
Training completed in 100.1s (1.7 min)

====================================================================================================
TEST SET EVALUATION
====================================================================================================
Test Accuracy: 33.02%

Top 10 Most Common Lithologies:
  nannofossil ooze              :   5010 samples, Acc=87.96%
  clay                          :   4007 samples, Acc=72.50%
  silty clay                    :   3128 samples, Acc=0.70%
  silty claystone               :   2655 samples, Acc=0.00%
  gabbro                        :   2520 samples, Acc=0.00%
  mud                           :   1978 samples, Acc=0.00%
  wackestone                    :   1690 samples, Acc=71.89%
  mudstone                      :    872 samples, Acc=64.56%
  chalk                         :    851 samples, Acc=0.00%
  interbedded silt and clay     :    739 samples, Acc=19.62%

====================================================================================================
✓ Classifier trained successfully
  Test Accuracy: 33.02%
  Model saved: ml_models/checkpoints/lithology_classifier_v2_6_7_best.pth
====================================================================================================
