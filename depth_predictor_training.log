/home/other/johna/.local/lib/python3.10/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.8.1' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/home/other/johna/.local/lib/python3.10/site-packages/pandas/core/arrays/masked.py:60: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.2' currently installed).
  from pandas.core import (
/usr/lib/python3/dist-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.17.3 and <1.25.0 is required for this version of SciPy (detected version 1.26.4
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/other/johna/.local/lib/python3.10/site-packages/matplotlib/projections/__init__.py:63: UserWarning: Unable to import Axes3D. This may be due to multiple versions of Matplotlib being installed (e.g. as a system package and as a pip package). As a result, the 3D projection is not available.
  warnings.warn("Unable to import Axes3D. This may be due to multiple versions of "
================================================================================
DEPTH PREDICTION FROM SEMI-SUPERVISED VAE v2.14 EMBEDDINGS
================================================================================

Loading dataset...
Total samples: 238,506
Depth range: 0.0 - 1800.2 m

Scaling features...

Loading Semi-Supervised VAE v2.14...
Device: cuda
✓ Model loaded (epoch 4)

Generating 10D latent embeddings...
Embeddings shape: (238506, 10)
Embedding statistics:
  z0: mean=-0.4200, std= 0.3245
  z1: mean=-0.2257, std= 0.4257
  z2: mean= 0.0643, std= 0.6671
  z3: mean=-0.0731, std= 1.0231
  z4: mean=-0.6058, std= 0.8090
  z5: mean= 0.2993, std= 0.8526
  z6: mean= 0.1326, std= 0.7683
  z7: mean=-0.0644, std= 0.4406
  z8: mean= 0.0841, std= 0.9325
  z9: mean= 0.1891, std= 0.3307

Creating borehole-level train/test split...
Training samples: 194,268 (236 boreholes)
Test samples: 44,238 (60 boreholes)
Train depth range: 0.0 - 1800.2 m
Test depth range: 0.0 - 1705.8 m

Training CatBoost depth predictor...
0:	learn: 0.0501175	test: 0.0062174	best: 0.0062174 (0)	total: 63.5ms	remaining: 1m 3s
100:	learn: 0.5038792	test: 0.3809051	best: 0.3809051 (100)	total: 1.3s	remaining: 11.6s
200:	learn: 0.5518623	test: 0.3967978	best: 0.3967978 (200)	total: 2.68s	remaining: 10.7s
300:	learn: 0.5782081	test: 0.4041472	best: 0.4049849 (290)	total: 3.83s	remaining: 8.9s
Stopped by overfitting detector  (50 iterations wait)

bestTest = 0.4069381745
bestIteration = 335

Shrink model to first 336 iterations.

✓ Model saved: ml_models/depth_predictor_v2_14.cbm

================================================================================
EVALUATION RESULTS
================================================================================

Training Set:
  R² Score:  0.5851
  MAE:       122.26 m
  RMSE:      178.13 m

Test Set:
  R² Score:  0.4069
  MAE:       198.46 m
  RMSE:      293.53 m

Feature Importance (Latent Dimensions):
  z0:     5.44
  z1:     4.37
  z2:     7.32
  z3:    16.00
  z4:     9.64
  z5:    18.69
  z6:    14.16
  z7:     5.47
  z8:     9.09
  z9:     9.82

✓ Saved: depth_predictor_feature_importance.csv

Creating visualization...
✓ Saved: depth_predictor_v2_14_results.png

================================================================================
COMPLETE
================================================================================
