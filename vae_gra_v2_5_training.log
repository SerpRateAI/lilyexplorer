/home/other/johna/.local/lib/python3.10/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.8.1' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/home/other/johna/.local/lib/python3.10/site-packages/pandas/core/arrays/masked.py:61: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.2' currently installed).
  from pandas.core import (
/usr/lib/python3/dist-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.17.3 and <1.25.0 is required for this version of SciPy (detected version 1.26.4
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
Warning: UMAP not available, will use PCA only for 8D visualization
/home/other/johna/.local/lib/python3.10/site-packages/matplotlib/projections/__init__.py:63: UserWarning: Unable to import Axes3D. This may be due to multiple versions of Matplotlib being installed (e.g. as a system package and as a pip package). As a result, the 3D projection is not available.
  warnings.warn("Unable to import Axes3D. This may be due to multiple versions of "
================================================================================
VAE LITHOLOGY MODEL v2.5 - Low β (β=0.01) for Better Clustering
================================================================================
Using device: cpu
Using β=0.01 (low disentanglement for clustering)

Loading data...
Loaded 238,506 samples from 296 boreholes
After removing NaN: 238,506 samples

Applying distribution-aware scaling:
  GRA bulk density:         Gaussian      → StandardScaler
  Magnetic susceptibility:  Poisson       → sign(x)*log(|x|+1) + StandardScaler
  NGR:                      Bimodal       → sign(x)*log(|x|+1) + StandardScaler
  R, G, B:                  Log-normal    → log(x+1) + StandardScaler
Found 139 unique lithologies

Data split by borehole:
  Train: 206 boreholes, 174,636 samples
  Val:   45 boreholes, 33,277 samples
  Test:  45 boreholes, 30,593 samples

================================================================================
TRAINING VAE WITH LATENT DIM = 2
================================================================================
Model parameters: 1,802

Training VAE with latent dim=2, beta=0.01
============================================================
Epoch   0: Train Loss=2.8041, Val Loss=1.4265, Recon=2.7457, KL=5.8447
Epoch   5: Train Loss=1.0347, Val Loss=0.8861, Recon=0.9593, KL=7.5457
Epoch  10: Train Loss=0.9517, Val Loss=0.8657, Recon=0.8755, KL=7.6244
Epoch  15: Train Loss=0.9195, Val Loss=0.8326, Recon=0.8426, KL=7.6873
Epoch  20: Train Loss=0.8992, Val Loss=0.8280, Recon=0.8206, KL=7.8533
Epoch  25: Train Loss=0.8776, Val Loss=0.7765, Recon=0.7999, KL=7.7640
Epoch  30: Train Loss=0.8598, Val Loss=0.7797, Recon=0.7824, KL=7.7438
Epoch  35: Train Loss=0.8452, Val Loss=0.8056, Recon=0.7685, KL=7.6714
Early stopping at epoch 37
Training time: 179.7s
Model saved to: /home/utig5/johna/bhai/ml_models/checkpoints/vae_gra_v2_5_latent2.pth

============================================================
CLUSTERING ANALYSIS
============================================================

n_clusters= 5: Silhouette=0.586, ARI=0.074
  Cluster  0 (n= 1716): nannofossil ooze (70.4%)
  Cluster  1 (n= 2809): clay (29.6%)
  Cluster  2 (n=20328): nannofossil ooze (18.1%)
  Cluster  3 (n= 2735): gabbro (91.3%)
  Cluster  4 (n= 3005): interbedded silt and clay (22.0%)

n_clusters=10: Silhouette=0.427, ARI=0.173
  Cluster  0 (n= 3412): clay (21.5%)
  Cluster  1 (n= 2504): gabbro (91.5%)
  Cluster  2 (n=  368): marl (49.7%)
  Cluster  3 (n= 7721): silty clay (26.4%)
  Cluster  4 (n= 1273): nannofossil ooze (51.8%)
  Cluster  5 (n= 2647): clay (30.3%)
  Cluster  6 (n= 2678): interbedded silt and clay (24.7%)
  Cluster  7 (n= 8266): nannofossil ooze (28.4%)
  Cluster  8 (n= 1436): nannofossil ooze (80.6%)
  Cluster  9 (n=  288): gabbro (74.7%)

n_clusters=15: Silhouette=0.400, ARI=0.187
  Cluster  0 (n= 2562): clay (31.1%)
  Cluster  1 (n= 4409): wackestone (33.5%)
  Cluster  2 (n=  841): nannofossil ooze (96.1%)
  Cluster  3 (n=  837): gabbro (77.1%)
  Cluster  4 (n=  347): marl (51.9%)
  Cluster  5 (n= 1610): mud (27.5%)
  Cluster  6 (n= 1673): gabbro (95.3%)
  Cluster  7 (n= 6634): silty claystone (32.9%)
  Cluster  8 (n=  976): nannofossil ooze (43.3%)
  Cluster  9 (n=  305): gabbro (88.5%)
  Cluster 10 (n= 1948): diatom ooze (28.4%)
  Cluster 11 (n= 5581): silty clay (34.4%)
  Cluster 12 (n=  155): clay (22.6%)
  Cluster 13 (n= 2069): clay (28.3%)
  Cluster 14 (n=  646): nannofossil ooze (58.7%)

n_clusters=20: Silhouette=0.410, ARI=0.194
  Cluster  0 (n= 5005): silty clay (37.8%)
  Cluster  1 (n= 1373): gabbro (95.0%)
  Cluster  2 (n=  813): nannofossil ooze (97.9%)
  Cluster  3 (n= 1320): mud (26.4%)
  Cluster  4 (n= 1943): clay (41.1%)
  Cluster  5 (n= 5882): silty claystone (35.6%)
  Cluster  6 (n=  989): nannofossil ooze (57.4%)
  Cluster  7 (n=  342): marl (52.6%)
  Cluster  8 (n=  129): gabbro (62.8%)
  Cluster  9 (n=  479): mudstone (30.7%)
  Cluster 10 (n= 2157): diatom ooze (26.1%)
  Cluster 11 (n=  902): gabbro (87.0%)
  Cluster 12 (n= 2888): wackestone (43.6%)
  Cluster 13 (n= 1933): clay (28.6%)
  Cluster 14 (n=  422): nannofossil ooze (54.5%)
  Cluster 15 (n=  353): gabbro (92.9%)
  Cluster 16 (n=  419): nannofossil ooze (41.8%)
  Cluster 17 (n= 2755): chalk (27.9%)
  Cluster 18 (n=  203): clay (21.7%)
  Cluster 19 (n=  286): mud (54.2%)

Generating visualizations...
Visualizations saved to: /home/utig5/johna/bhai/vae_v2_5_outputs

================================================================================
TRAINING VAE WITH LATENT DIM = 8
================================================================================
Model parameters: 2,102

Training VAE with latent dim=8, beta=0.01
============================================================
Epoch   0: Train Loss=2.3966, Val Loss=0.8804, Recon=2.2977, KL=9.8915
Epoch   5: Train Loss=0.6424, Val Loss=0.2878, Recon=0.5027, KL=13.9677
Epoch  10: Train Loss=0.5722, Val Loss=0.2523, Recon=0.4415, KL=13.0727
Epoch  15: Train Loss=0.5213, Val Loss=0.2385, Recon=0.4026, KL=11.8748
Epoch  20: Train Loss=0.4839, Val Loss=0.2069, Recon=0.3714, KL=11.2532
Epoch  25: Train Loss=0.4579, Val Loss=0.2028, Recon=0.3447, KL=11.3218
Epoch  30: Train Loss=0.4505, Val Loss=0.2024, Recon=0.3357, KL=11.4756
Epoch  35: Train Loss=0.4429, Val Loss=0.2139, Recon=0.3273, KL=11.5586
Epoch  40: Train Loss=0.4326, Val Loss=0.1948, Recon=0.3161, KL=11.6495
Epoch  45: Train Loss=0.4281, Val Loss=0.2036, Recon=0.3112, KL=11.6837
Epoch  50: Train Loss=0.4263, Val Loss=0.2091, Recon=0.3093, KL=11.6958
Early stopping at epoch 50
Training time: 227.6s
Model saved to: /home/utig5/johna/bhai/ml_models/checkpoints/vae_gra_v2_5_latent8.pth

============================================================
CLUSTERING ANALYSIS
============================================================

n_clusters= 5: Silhouette=0.335, ARI=0.092
  Cluster  0 (n= 5775): silty clay (24.6%)
  Cluster  1 (n= 4249): nannofossil ooze (42.7%)
  Cluster  2 (n= 1896): gabbro (95.4%)
  Cluster  3 (n= 2472): gabbro (28.4%)
  Cluster  4 (n=16201): nannofossil ooze (19.6%)

n_clusters=10: Silhouette=0.304, ARI=0.178
  Cluster  0 (n= 1471): clay (42.8%)
  Cluster  1 (n= 9400): nannofossil ooze (31.3%)
  Cluster  2 (n= 1371): gabbro (97.3%)
  Cluster  3 (n= 1666): nannofossil ooze (69.9%)
  Cluster  4 (n=  579): gabbro (80.8%)
  Cluster  5 (n= 7445): mud (25.1%)
  Cluster  6 (n= 2016): wackestone (60.6%)
  Cluster  7 (n= 3589): silty clay (36.9%)
  Cluster  8 (n=  857): gabbro (82.8%)
  Cluster  9 (n= 2199): clay (28.5%)

n_clusters=15: Silhouette=0.295, ARI=0.236
  Cluster  0 (n=  508): mud (20.3%)
  Cluster  1 (n= 1870): chalk (33.9%)
  Cluster  2 (n= 1894): wackestone (63.1%)
  Cluster  3 (n= 1354): gabbro (97.3%)
  Cluster  4 (n= 4575): mud (38.7%)
  Cluster  5 (n=  840): clay (34.9%)
  Cluster  6 (n= 1039): nannofossil ooze (94.2%)
  Cluster  7 (n= 5842): nannofossil ooze (50.5%)
  Cluster  8 (n= 1749): clay (35.7%)
  Cluster  9 (n=  833): gabbro (84.5%)
  Cluster 10 (n= 4675): silty claystone (30.5%)
  Cluster 11 (n=  981): calcareous ooze (30.3%)
  Cluster 12 (n=  569): gabbro (84.2%)
  Cluster 13 (n= 2759): silty clay (38.4%)
  Cluster 14 (n= 1105): clay (42.8%)

n_clusters=20: Silhouette=0.302, ARI=0.218
  Cluster  0 (n= 1144): clay (48.9%)
  Cluster  1 (n=  702): gabbro (92.9%)
  Cluster  2 (n= 1758): silty clay (25.8%)
  Cluster  3 (n=  711): calcareous ooze (35.9%)
  Cluster  4 (n= 1710): clay (36.2%)
  Cluster  5 (n=  317): nannofossil ooze (95.6%)
  Cluster  6 (n= 4125): silty claystone (28.6%)
  Cluster  7 (n= 1015): nannofossil ooze (54.2%)
  Cluster  8 (n=  206): foraminifera ooze (39.8%)
  Cluster  9 (n= 5045): nannofossil ooze (49.5%)
  Cluster 10 (n= 1709): wackestone (68.8%)
  Cluster 11 (n=  994): gabbro (98.7%)
  Cluster 12 (n=  466): gabbro (85.6%)
  Cluster 13 (n=  602): gabbro (78.4%)
  Cluster 14 (n=  205): clay (18.5%)
  Cluster 15 (n= 2152): mud (33.1%)
  Cluster 16 (n= 2695): silty clay (38.4%)
  Cluster 17 (n= 1560): chalk (32.0%)
  Cluster 18 (n= 2723): mud (41.8%)
  Cluster 19 (n=  754): nannofossil ooze (92.0%)

Generating visualizations...
  Computing PCA projection...
Visualizations saved to: /home/utig5/johna/bhai/vae_v2_5_outputs

================================================================================
TRAINING COMPLETE
================================================================================
Models saved to: /home/utig5/johna/bhai/ml_models/checkpoints
Visualizations saved to: /home/utig5/johna/bhai/vae_v2_5_outputs
