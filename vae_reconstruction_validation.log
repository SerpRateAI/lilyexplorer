/home/other/johna/.local/lib/python3.10/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.8.1' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/home/other/johna/.local/lib/python3.10/site-packages/pandas/core/arrays/masked.py:61: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.2' currently installed).
  from pandas.core import (
/usr/lib/python3/dist-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.17.3 and <1.25.0 is required for this version of SciPy (detected version 1.26.4
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
/home/other/johna/.local/lib/python3.10/site-packages/matplotlib/projections/__init__.py:63: UserWarning: Unable to import Axes3D. This may be due to multiple versions of Matplotlib being installed (e.g. as a system package and as a pip package). As a result, the 3D projection is not available.
  warnings.warn("Unable to import Axes3D. This may be due to multiple versions of "
====================================================================================================
VAE v2.6.7 RECONSTRUCTION QUALITY VALIDATION
====================================================================================================

Loading data...
Total samples: 238,506

Loading VAE v2.6.7 model...
Warning: UMAP not available, will use PCA only for 8D visualization
✓ VAE model loaded

Scaling features (distribution-aware)...
✓ Features scaled

Computing VAE reconstructions...
✓ Reconstructions computed: (238506, 6)

====================================================================================================
RECONSTRUCTION QUALITY METRICS
====================================================================================================

Feature                       MAE         RMSE           R²
----------------------------------------------------------------------------------------------------
GRA (g/cm³)                0.3093       0.4049        0.836
MS (instr.)                0.3226       0.4147        0.828
NGR (cps)                  0.2660       0.3468        0.880
R                          0.1430       0.1956        0.962
G                          0.1378       0.1844        0.966
B                          0.1734       0.2225        0.950

Average MAE:  0.2254
Average RMSE: 0.2948
Average R²:   0.904

====================================================================================================
LATENT SPACE ANALYSIS
====================================================================================================

Dimension            Mean          Std       Active
----------------------------------------------------------------------------------------------------
Latent 0          -0.0016       0.9856            ✓
Latent 1          -0.0108       0.8075            ✓
Latent 2           0.0054       0.0078            ✗
Latent 3          -0.0175       0.2832            ✓
Latent 4          -0.0022       0.0155            ✗
Latent 5           0.0001       0.0053            ✗
Latent 6          -0.0102       0.0259            ✗
Latent 7           0.0014       0.0173            ✗
Latent 8           0.0015       0.3600            ✓
Latent 9          -0.0003       0.0096            ✗

Active dimensions (std > 0.1): 4/10
Effective dimensionality: 4D

====================================================================================================
RECONSTRUCTION ERROR BY LITHOLOGY GROUP
====================================================================================================

Lithology Group                   N_Samples      Avg_MAE      Quality
----------------------------------------------------------------------------------------------------
Carbonate                           100,531       0.2222       ○ Good
Clay/Mud                             96,930       0.2146       ○ Good
Sand                                 13,253       0.2250       ○ Good
Biogenic Silica                       7,414       0.2832       ✗ Poor
Silt                                  6,951       0.2153       ○ Good
Mafic Igneous                         5,955       0.2965       ✗ Poor
Volcaniclastic                        4,187       0.2817       ✗ Poor
Conglomerate/Breccia                  2,197       0.3141       ✗ Poor
Other                                   319       0.3141       ✗ Poor
Intermediate/Felsic Igneous             284       0.4202       ✗ Poor
Evaporite                               176       0.3854       ✗ Poor
Metamorphic                             162       0.3662       ✗ Poor
Ultramafic                               81       0.2715       ✗ Poor
Diamict                                  66       0.2791       ✗ Poor

Creating visualizations...
✓ Visualization saved: vae_reconstruction_validation.png

====================================================================================================
SUMMARY
====================================================================================================

VAE Reconstruction Quality: Excellent (R² = 0.904)
Effective Latent Dimensionality: 4/10 dimensions active

KEY FINDINGS:

1. VAE successfully achieves its unsupervised objective:
   - Compresses 6D physical properties into 4D latent space
   - Reconstructs inputs with excellent quality (avg R² = 0.904)

2. While reconstruction is strong, classification is weak:
   - Direct classifier (raw features):    42.32% balanced accuracy
   - VAE classifier v1.1 (embeddings):    29.73% balanced accuracy
   - VAE loses 42.3% discriminative power during compression

3. The VAE optimizes for reconstruction, not separation:
   - 4/10 latent dimensions are active (6 collapsed)
   - Latent space captures variance, not lithology-specific patterns
   - Physically similar lithologies (clay/mud, sand/silt) cluster together

CONCLUSION:

The VAE v2.6.7 model works as designed for unsupervised learning:
✓ Compresses physical properties efficiently
✓ Preserves reconstruction quality
✓ Learns without lithology labels

However, the learned embeddings have limited value for lithology classification
because the VAE objective (reconstruction) differs from the classification objective
(separating lithology groups).

For the oceanic crust AI model, the VAE embeddings are suitable for:
- Unsupervised exploration of physical property patterns
- Dimensionality reduction for visualization
- Anomaly detection (reconstruction error)
- Feature extraction for downstream tasks that don't require fine-grained discrimination

====================================================================================================
