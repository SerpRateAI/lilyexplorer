/home/other/johna/.local/lib/python3.10/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.8.1' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/home/other/johna/.local/lib/python3.10/site-packages/pandas/core/arrays/masked.py:61: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.2' currently installed).
  from pandas.core import (
/usr/lib/python3/dist-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.17.3 and <1.25.0 is required for this version of SciPy (detected version 1.26.4
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
================================================================================
VAE GRA v2.11 - Random Masking (15%)
================================================================================

Loading data...
Dataset: 238,506 samples
Train: 174,636, Val: 33,277, Test: 30,593

================================================================================
Training with RANDOM masking (15% per feature)
================================================================================
Device: cpu
Epoch   0: β=0.0010, Train Loss=2.5720, Val Loss=0.7061
Epoch   5: β=0.0509, Train Loss=1.4879, Val Loss=0.8305
Epoch  10: β=0.1008, Train Loss=1.6654, Val Loss=1.1023

Early stopping at epoch 11

Training completed in 72.5s (12 epochs)

================================================================================
Clustering Evaluation
================================================================================
k=10: ARI=0.222, Silhouette=0.392
k=12: ARI=0.248, Silhouette=0.396
k=15: ARI=0.248, Silhouette=0.360
k=20: ARI=0.233, Silhouette=0.334

================================================================================
IMPUTATION TEST: Predict NGR+RGB from GRA+MS
================================================================================

True values:
     GRA       MS       NGR       R        G        B
1:  1.267    65.90   24.88    32.6    27.9    24.7
2:  1.314    78.81   17.17    33.6    30.7    28.8
3:  1.362   146.19   19.26    32.1    28.8    27.5
4:  1.432   209.50   21.04    30.7    27.8    27.0
5:  1.407   124.12   19.38    31.5    28.5    27.6
6:  1.336   106.89   18.01    33.2    29.9    28.3
7:  1.295    88.50   17.43    32.8    29.4    28.1
8:  1.376   136.63   19.25    33.3    30.4    30.0
9:  1.417    85.94   23.09    34.2    31.0    30.5
10:  1.425    39.44   24.61    34.5    31.5    30.9

Imputed values (given GRA+MS):
     GRA       MS       NGR       R        G        B
1:  1.333    38.57   14.88    57.2    54.9    49.5
2:  1.405    31.46   18.36    62.1    59.7    53.4
3:  1.371    46.46   14.71    53.3    51.3    46.3
4:  1.510    60.32   14.37    57.5    55.6    50.3
5:  1.463    27.35   22.08    46.0    44.1    39.1
6:  1.456    44.90    9.41    45.9    44.3    40.2
7:  1.434    34.92   16.58    66.1    63.7    57.1
8:  1.393   106.91   11.29    38.0    36.5    33.2
9:  1.433    67.38   13.71    43.5    41.9    37.9
10:  1.405    40.35   15.90    56.3    54.2    48.8

Imputation MSE:
  NGR: 47.60
  RGB: 446.66

Model saved: ml_models/checkpoints/vae_gra_v2_11_masked_random.pth

================================================================================
Comparison to v2.6 Baseline
================================================================================
v2.6 (no masking):       ARI (k=12) = 0.258
v2.11 (block NGR+RGB):   ARI (k=12) = 0.236 (-8.5%)
v2.11 (random 15%):      ARI (k=12) = 0.248
Improvement over v2.6: -3.8%
