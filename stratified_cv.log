/home/other/johna/.local/lib/python3.10/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.4' or newer of 'numexpr' (version '2.8.1' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/home/other/johna/.local/lib/python3.10/site-packages/pandas/core/arrays/masked.py:61: UserWarning: Pandas requires version '1.3.6' or newer of 'bottleneck' (version '1.3.2' currently installed).
  from pandas.core import (
/usr/lib/python3/dist-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.17.3 and <1.25.0 is required for this version of SciPy (detected version 1.26.4
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
Warning: UMAP not available, will use PCA only for 8D visualization
/home/other/johna/.local/lib/python3.10/site-packages/matplotlib/projections/__init__.py:63: UserWarning: Unable to import Axes3D. This may be due to multiple versions of Matplotlib being installed (e.g. as a system package and as a pip package). As a result, the 3D projection is not available.
  warnings.warn("Unable to import Axes3D. This may be due to multiple versions of "
====================================================================================================
STRATIFIED CROSS-VALIDATION BY GEOGRAPHIC REGION
====================================================================================================

Loading geographic data...
/home/utig5/johna/bhai/stratified_cv_v2_6_6.py:168: DtypeWarning: Columns (0,5,6,16,17,19,20,22) have mixed types. Specify dtype option on import or set low_memory=False.
  gra = pd.read_csv('/home/utig5/johna/bhai/datasets/GRA_DataLITH.csv')
Total boreholes: 296
Latitude range: -76.6° to 43.8°
Longitude range: -179.7° to 179.2°

Created 5 geographic regions:
  Region 0: 102 boreholes, Lat=[-34.3, 19.1], Lon=[67.9, 121.8]
  Region 1: 17 boreholes, Lat=[-76.6, -68.6], Lon=[-179.7, -107.5]
  Region 2: 109 boreholes, Lat=[-3.1, 43.8], Lon=[114.9, 147.2]
  Region 3: 35 boreholes, Lat=[-41.4, -15.8], Lon=[17.4, 57.3]
  Region 4: 33 boreholes, Lat=[-39.0, -26.5], Lon=[128.0, 179.2]

Device: cuda
K-fold CV: 5 folds (stratified by region)

====================================================================================================
FOLD 1/5
====================================================================================================
Train regions: {0: 81, 1: 13, 2: 87, 3: 28, 4: 27}
Test regions:  {0: 21, 1: 4, 2: 22, 3: 7, 4: 6}
Train: 145,380 samples (201 boreholes)
Val:   30,311 samples (35 boreholes)
Test:  62,815 samples (60 boreholes)

Results:
  Training time: 51.4s
  Collapsed dims: 6/10
  Effective dim: 4
  Best clustering: k=12, ARI=0.2199, Sil=0.1792

====================================================================================================
FOLD 2/5
====================================================================================================
Train regions: {0: 82, 1: 14, 2: 87, 3: 28, 4: 26}
Test regions:  {0: 20, 1: 3, 2: 22, 3: 7, 4: 7}
Train: 164,892 samples (202 boreholes)
Val:   36,527 samples (35 boreholes)
Test:  37,087 samples (59 boreholes)

Results:
  Training time: 58.4s
  Collapsed dims: 6/10
  Effective dim: 4
  Best clustering: k=10, ARI=0.1928, Sil=0.2101

====================================================================================================
FOLD 3/5
====================================================================================================
Train regions: {0: 82, 1: 14, 2: 87, 3: 28, 4: 26}
Test regions:  {0: 20, 1: 3, 2: 22, 3: 7, 4: 7}
Train: 167,545 samples (202 boreholes)
Val:   23,266 samples (35 boreholes)
Test:  47,695 samples (59 boreholes)

Results:
  Training time: 58.1s
  Collapsed dims: 6/10
  Effective dim: 4
  Best clustering: k=10, ARI=0.1526, Sil=0.1652

====================================================================================================
FOLD 4/5
====================================================================================================
Train regions: {0: 82, 1: 14, 2: 87, 3: 28, 4: 26}
Test regions:  {0: 20, 1: 3, 2: 22, 3: 7, 4: 7}
Train: 168,110 samples (202 boreholes)
Val:   26,431 samples (35 boreholes)
Test:  43,965 samples (59 boreholes)

Results:
  Training time: 58.1s
  Collapsed dims: 6/10
  Effective dim: 4
  Best clustering: k=15, ARI=0.1863, Sil=0.2103

====================================================================================================
FOLD 5/5
====================================================================================================
Train regions: {0: 81, 1: 13, 2: 88, 3: 28, 4: 27}
Test regions:  {0: 21, 1: 4, 2: 21, 3: 7, 4: 6}
Train: 166,347 samples (202 boreholes)
Val:   25,215 samples (35 boreholes)
Test:  46,944 samples (59 boreholes)

Results:
  Training time: 57.6s
  Collapsed dims: 6/10
  Effective dim: 4
  Best clustering: k=10, ARI=0.2301, Sil=0.1883

====================================================================================================
STRATIFIED CROSS-VALIDATION SUMMARY
====================================================================================================

 fold  train_samples  test_samples  train_time  collapsed_dims  effective_dim  best_k  best_ari  best_sil
    1         145380         62815   51.378646               6              4      12  0.219898  0.179232
    2         164892         37087   58.360221               6              4      10  0.192829  0.210052
    3         167545         47695   58.129615               6              4      10  0.152621  0.165230
    4         168110         43965   58.072888               6              4      15  0.186271  0.210341
    5         166347         46944   57.613078               6              4      10  0.230095  0.188266

ARI Statistics:
  Mean: 0.1963
  Std:  0.0305
  Min:  0.1526
  Max:  0.2301
  95% CI: [0.1366, 0.2561]

====================================================================================================
COMPARISON TO ORIGINAL v2.6.6
====================================================================================================
Original v2.6.6 (random split):     ARI = 0.286
Stratified CV mean:                 ARI = 0.1963 ± 0.0305

⚠️  Original result outside 95% CI of stratified CV
====================================================================================================

Results saved to: v2_6_6_stratified_cv.csv
